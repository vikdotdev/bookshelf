# Logfile created on 2022-12-17 21:41:49 +0200 by logger.rb/v1.5.0
[bookshelf] [INFO] [2022-12-17 21:41:49 +0200] GET 200 23µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 21:42:06 +0200] GET 200 128µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:32:58 +0200] GET 200 37µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:34:22 +0200] GET 200 8ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:35:00 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:35:18 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:36:23 +0200] GET 200 6ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:36:23 +0200] GET 404 11µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:36:55 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:37:54 +0200] GET 200 6ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:38:07 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:38:07 +0200] GET 200 537µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:38:35 +0200] GET 200 5ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:38:35 +0200] GET 200 600µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:45:59 +0200] GET 200 4ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:45:59 +0200] GET 200 546µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:46:43 +0200] GET 200 5ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:46:43 +0200] GET 200 581µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:49:45 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:49:45 +0200] GET 200 760µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:51:50 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:51:50 +0200] GET 200 636µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:56:20 +0200] GET 200 5ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-17 23:56:20 +0200] GET 200 592µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:58:28 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-17 23:59:55 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:00:12 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:00:21 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:01:37 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:05:28 +0200] GET 200 214338ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:05:52 +0200] GET 200 6ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:05:54 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:06:24 +0200] GET 200 6ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:06:24 +0200] GET 200 585µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:06:33 +0200] GET 200 6ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:06:33 +0200] GET 200 624µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:06:36 +0200] GET 200 7ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:06:36 +0200] GET 200 633µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:07:01 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:07:02 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:07:51 +0200] GET 200 6ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:07:51 +0200] GET 200 762µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:08:16 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:08:16 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:08:43 +0200] GET 200 9ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:08:43 +0200] GET 200 644µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:08:49 +0200] GET 200 6ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:08:49 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:09:36 +0200] GET 500 0µs 127.0.0.1 /books -
  undefined method `per_page' for #<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"title\"">>

            .per_page(5)
            ^^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/index.rb:12:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/index_spec.rb:12:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:09:36 +0200] GET 200 6ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:09:59 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:09:59 +0200] GET 200 7ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:10:18 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:10:18 +0200] GET 200 7ms 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-12-18 00:13:40 +0200] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x00007fce37d84340 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007fce38b8d810 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007fce37e5af80 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007fce38eabc90 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007fce37d84570 @router=#<Hanami::Slice::Router:0x00007fce37dbffd0 @path_prefix=#<Hanami::Router::Prefix:0x00007fce37dbf648 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007fce37dbfee0 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007fce37dc4ad0 @notifications=#<Dry::Monitor::Notifications:0x00007fce38d895b0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007fce38d85e88 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007fce37dc95f8 @listeners=#<Concurrent::Map:0x00007fce37dc96c0 entries=3 default_proc=#<Proc:0x00007fce3c61cad0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007fce37dc9990 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007fce37dc4b48 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007fce37dbf5f8 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007fce37dbf580 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007fce37dc0278 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007fce38da4888 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007fce37dbef90 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007fce37db7128 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007fce37db7f60 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007fce37db6f48 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007fce38f326f0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007fce37dc4ad0 @notifications=#<Dry::Monitor::Notifications:0x00007fce38d895b0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007fce38d85e88 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007fce37dc95f8 @listeners=#<Concurrent::Map:0x00007fce37dc96c0 entries=3 default_proc=#<Proc:0x00007fce3c61cad0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007fce37dc9990 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007fce37dc4b48 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007fce37d99100 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007fce37d99088 @chain=[]>}>>

            .page(request.params[:page] || 1)
                  ^^^^^^^
Did you mean?  require (NameError)
  /home/vik/repos/bookshelf/app/actions/books/index.rb:13:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/index_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:13:40 +0200] GET 200 1ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:13:48 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:13:48 +0200] GET 200 7ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:13:56 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:13:56 +0200] GET 200 7ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"4"}
[bookshelf] [INFO] [2022-12-18 00:14:48 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:14:48 +0200] GET 200 11ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:16:33 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:16:33 +0200] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined method `invalid?' for #<Bookshelf::Actions::Books::Index::Params:0x00007f22f0479900 @env={"rack.version"=>[1, 3], "rack.input"=>#<StringIO:0x00007f22f04b5630>, "rack.errors"=>#<StringIO:0x00007f22f04b5720>, "rack.multithread"=>true, "rack.multiprocess"=>true, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "SERVER_NAME"=>"example.org", "SERVER_PORT"=>"80", "QUERY_STRING"=>"page=1&per_page=3", "PATH_INFO"=>"/books", "rack.url_scheme"=>"http", "HTTPS"=>"off", "SCRIPT_NAME"=>"", "CONTENT_LENGTH"=>"0", "rack.test"=>true, "REMOTE_ADDR"=>"127.0.0.1", "SERVER_PROTOCOL"=>"HTTP/1.0", "HTTP_VERSION"=>"HTTP/1.0", "HTTP_HOST"=>"example.org", "HTTP_COOKIE"=>"", "router.params"=>{:page=>"1", :per_page=>"3"}, "rack.request.query_string"=>"page=1&per_page=3", "rack.request.query_hash"=>{"page"=>"1", "per_page"=>"3"}}, @input={"page"=>"1", "per_page"=>"3", :page=>"1", :per_page=>"3"}, @params={:page=>1, :per_page=>3}, @errors={}>

          if request.params.invalid?
                           ^^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/index.rb:13:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/index_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:16:39 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:18:06 +0200] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined method `invalid?' for #<Bookshelf::Actions::Books::Index::Params:0x00007f83ae1af7f0 @env={"rack.version"=>[1, 3], "rack.input"=>#<StringIO:0x00007f83aced4860>, "rack.errors"=>#<StringIO:0x00007f83aced4950>, "rack.multithread"=>true, "rack.multiprocess"=>true, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "SERVER_NAME"=>"example.org", "SERVER_PORT"=>"80", "QUERY_STRING"=>"page=1&per_page=3", "PATH_INFO"=>"/books", "rack.url_scheme"=>"http", "HTTPS"=>"off", "SCRIPT_NAME"=>"", "CONTENT_LENGTH"=>"0", "rack.test"=>true, "REMOTE_ADDR"=>"127.0.0.1", "SERVER_PROTOCOL"=>"HTTP/1.0", "HTTP_VERSION"=>"HTTP/1.0", "HTTP_HOST"=>"example.org", "HTTP_COOKIE"=>"", "router.params"=>{:page=>"1", :per_page=>"3"}, "rack.request.query_string"=>"page=1&per_page=3", "rack.request.query_hash"=>{"page"=>"1", "per_page"=>"3"}}, @input={"page"=>"1", "per_page"=>"3", :page=>"1", :per_page=>"3"}, @params={:page=>1, :per_page=>3}, @errors={}> (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/index.rb:14:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/index_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:18:07 +0200] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined method `invalid?' for #<Bookshelf::Actions::Books::Index::Params:0x00007f758ad8e350 @env={"rack.version"=>[1, 3], "rack.input"=>#<StringIO:0x00007f758adfd020>, "rack.errors"=>#<StringIO:0x00007f758adfd138>, "rack.multithread"=>true, "rack.multiprocess"=>true, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "SERVER_NAME"=>"example.org", "SERVER_PORT"=>"80", "QUERY_STRING"=>"page=1&per_page=3", "PATH_INFO"=>"/books", "rack.url_scheme"=>"http", "HTTPS"=>"off", "SCRIPT_NAME"=>"", "CONTENT_LENGTH"=>"0", "rack.test"=>true, "REMOTE_ADDR"=>"127.0.0.1", "SERVER_PROTOCOL"=>"HTTP/1.0", "HTTP_VERSION"=>"HTTP/1.0", "HTTP_HOST"=>"example.org", "HTTP_COOKIE"=>"", "router.params"=>{:page=>"1", :per_page=>"3"}, "rack.request.query_string"=>"page=1&per_page=3", "rack.request.query_hash"=>{"page"=>"1", "per_page"=>"3"}}, @input={"page"=>"1", "per_page"=>"3", :page=>"1", :per_page=>"3"}, @params={:page=>1, :per_page=>3}, @errors={}>

          if request.params.invalid?
                           ^^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/index.rb:16:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/index_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:18:07 +0200] GET 200 6ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:18:19 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:18:19 +0200] GET 200 11ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:19:44 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:19:44 +0200] GET 200 10ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:19:44 +0200] GET 200 733µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:20:24 +0200] GET 200 15ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:20:24 +0200] GET 200 845µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:20:24 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:20:24 +0200] GET 200 661µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:20:48 +0200] GET 200 5ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:20:48 +0200] GET 422 12ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:20:48 +0200] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:20:48 +0200] GET 200 699µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:21:59 +0200] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:21:59 +0200] GET 200 940µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:21:59 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:22:08 +0200] GET 404 14µs 127.0.0.1 /books/23 -
[bookshelf] [INFO] [2022-12-18 00:22:08 +0200] GET 404 9µs 127.0.0.1 /books/1 -
[bookshelf] [INFO] [2022-12-18 00:22:08 +0200] GET 200 823µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 200 10ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 404 10µs 127.0.0.1 /books/1 -
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 404 6µs 127.0.0.1 /books/3 -
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:22:15 +0200] GET 200 780µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [ERROR] [2022-12-18 00:27:10 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f0e407fcab0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f0e41643470 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f0e40906140 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f0e418f2130 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f0e407fcce0 @router=#<Hanami::Slice::Router:0x00007f0e408281b0 @path_prefix=#<Hanami::Router::Prefix:0x00007f0e40827828 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f0e408280c0 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f0e408277d8 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f0e40827760 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f0e40828430 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f0e41b960a8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f0e40827170 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f330 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f0e40820190 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f150 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f0e4081edb8 @root=#<Hanami::Router::Node:0x00007f0e4081ed18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081e9d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e4081a9c0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40819868 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f0e4081a6f0 @root=#<Hanami::Router::Node:0x00007f0e4081a6c8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081a4e8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e40819b60 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40818bc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f0e450df110 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6d30 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6cb8 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:25:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:16:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:27:10 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f0e419684c0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f0e41643470 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f0e40906140 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f0e418f2130 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f0e419689c0 @router=#<Hanami::Slice::Router:0x00007f0e408281b0 @path_prefix=#<Hanami::Router::Prefix:0x00007f0e40827828 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f0e408280c0 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f0e408277d8 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f0e40827760 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f0e40828430 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f0e41b960a8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f0e40827170 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f330 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f0e40820190 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f150 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f0e4081edb8 @root=#<Hanami::Router::Node:0x00007f0e4081ed18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081e9d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e4081a9c0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40819868 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f0e4081a6f0 @root=#<Hanami::Router::Node:0x00007f0e4081a6c8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081a4e8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e40819b60 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40818bc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f0e450df110 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6d30 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6cb8 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:25:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:16:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:10:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:27:10 +0200] GET 500 0µs   -
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f0e40a847b0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f0e41643470 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f0e40906140 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f0e418f2130 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f0e40a84b20 @router=#<Hanami::Slice::Router:0x00007f0e408281b0 @path_prefix=#<Hanami::Router::Prefix:0x00007f0e40827828 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f0e408280c0 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f0e408277d8 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f0e40827760 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f0e40828430 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f0e41b960a8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f0e40827170 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f330 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f0e40820190 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f0e4081f150 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f0e4081edb8 @root=#<Hanami::Router::Node:0x00007f0e4081ed18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081e9d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e4081a9c0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40819868 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f0e4081a6f0 @root=#<Hanami::Router::Node:0x00007f0e4081a6c8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f0e4081a4e8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f0e40819b60 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f0e40818bc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f0e450df110 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f0e4082cc88 @notifications=#<Dry::Monitor::Notifications:0x00007f0e4182c160 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f0e41828498 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f0e40831788 @listeners=#<Concurrent::Map:0x00007f0e40831850 entries=3 default_proc=#<Proc:0x00007f0e450ae150 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f0e40831b20 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f0e4082cd00 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6d30 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f0e408f6cb8 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:25:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:16:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/show_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:27:10 +0200] GET 422 3ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:27:10 +0200] GET 200 965µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:27:10 +0200] GET 200 605µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:27:10 +0200] GET 200 549µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:27:33 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f2938424df8 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f29392653e0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f293852e4d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f293951adb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f2938425028 @router=#<Hanami::Slice::Router:0x00007f29384504f8 @path_prefix=#<Hanami::Router::Prefix:0x00007f293844fb70 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f2938450408 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f293844fb20 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f293844faa8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f2938450778 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f293948b7c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f293844f4b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447678 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f29384484d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f2938447100 @root=#<Hanami::Router::Node:0x00007f2938447060 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938446d18 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938442d08 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938441bb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f2938442a38 @root=#<Hanami::Router::Node:0x00007f2938442a10 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938442830 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938441ea8 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938440f08 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f293cd06850 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f078 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f000 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:27:33 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f293959c450 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f29392653e0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f293852e4d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f293951adb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f293959c928 @router=#<Hanami::Slice::Router:0x00007f29384504f8 @path_prefix=#<Hanami::Router::Prefix:0x00007f293844fb70 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f2938450408 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f293844fb20 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f293844faa8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f2938450778 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f293948b7c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f293844f4b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447678 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f29384484d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f2938447100 @root=#<Hanami::Router::Node:0x00007f2938447060 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938446d18 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938442d08 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938441bb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f2938442a38 @root=#<Hanami::Router::Node:0x00007f2938442a10 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938442830 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938441ea8 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938440f08 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f293cd06850 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f078 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f000 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:10:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:27:33 +0200] GET 500 0µs   -
  undefined local variable or method `row' for #<Bookshelf::Actions::Books::Show:0x00007f2938ef6420 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f29392653e0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f293852e4d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f293951adb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f2938ef6628 @router=#<Hanami::Slice::Router:0x00007f29384504f8 @path_prefix=#<Hanami::Router::Prefix:0x00007f293844fb70 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f2938450408 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f293844fb20 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f293844faa8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f2938450778 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f293948b7c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f293844f4b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447678 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f29384484d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f2938447498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f2938447100 @root=#<Hanami::Router::Node:0x00007f2938447060 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938446d18 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938442d08 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938441bb0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f2938442a38 @root=#<Hanami::Router::Node:0x00007f2938442a10 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f2938442830 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f2938441ea8 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f2938440f08 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f293cd06850 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f2938454fd0 @notifications=#<Dry::Monitor::Notifications:0x00007f29394450e8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f2939438d98 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f2938459ad0 @listeners=#<Concurrent::Map:0x00007f2938459b98 entries=3 default_proc=#<Proc:0x00007f293ccd9d00 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f2938459e68 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f2938455048 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f078 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f293851f000 @chain=[]>}>>

          row.relations[:books].by_pk(request.params.book_id).one
          ^^^
Did you mean?  rom
               @rom (NameError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/show_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:27:33 +0200] GET 200 1ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:27:33 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:27:33 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:27:33 +0200] GET 200 638µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:27:42 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:27:42 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined method `book_id' for #<Bookshelf::Actions::Books::Show::Params:0x00007f182e97b740 @env={"rack.version"=>[1, 3], "rack.input"=>#<StringIO:0x00007f182e84d710>, "rack.errors"=>#<StringIO:0x00007f182e84d850>, "rack.multithread"=>true, "rack.multiprocess"=>true, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "SERVER_NAME"=>"example.org", "SERVER_PORT"=>"80", "QUERY_STRING"=>"", "PATH_INFO"=>"/books/1", "rack.url_scheme"=>"http", "HTTPS"=>"off", "SCRIPT_NAME"=>"", "CONTENT_LENGTH"=>"0", "rack.test"=>true, "REMOTE_ADDR"=>"127.0.0.1", "SERVER_PROTOCOL"=>"HTTP/1.0", "HTTP_VERSION"=>"HTTP/1.0", "HTTP_HOST"=>"example.org", "HTTP_COOKIE"=>"", "router.params"=>{:id=>"1"}, "rack.request.query_string"=>"", "rack.request.query_hash"=>{}}, @input={:id=>"1"}, @params={}, @errors={:book_id=>["is missing"]}>

          rom.relations[:books].by_pk(request.params.book_id).one
                                                    ^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:10:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:27:42 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  undefined method `book_id' for #<Bookshelf::Actions::Books::Show::Params:0x00007f182e4c7050 @env={"rack.version"=>[1, 3], "rack.input"=>#<StringIO:0x00007f182e409758>, "rack.errors"=>#<StringIO:0x00007f182e409960>, "rack.multithread"=>true, "rack.multiprocess"=>true, "rack.run_once"=>false, "REQUEST_METHOD"=>"GET", "SERVER_NAME"=>"example.org", "SERVER_PORT"=>"80", "QUERY_STRING"=>"", "PATH_INFO"=>"/books/1", "rack.url_scheme"=>"http", "HTTPS"=>"off", "SCRIPT_NAME"=>"", "CONTENT_LENGTH"=>"0", "rack.test"=>true, "REMOTE_ADDR"=>"127.0.0.1", "SERVER_PROTOCOL"=>"HTTP/1.0", "HTTP_VERSION"=>"HTTP/1.0", "HTTP_HOST"=>"example.org", "HTTP_COOKIE"=>"", "router.params"=>{:id=>"1"}, "rack.request.query_string"=>"", "rack.request.query_hash"=>{}}, @input={:id=>"1"}, @params={}, @errors={:book_id=>["is missing"]}>

          rom.relations[:books].by_pk(request.params.book_id).one
                                                    ^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:27:42 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:27:42 +0200] GET 200 779µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:27:42 +0200] GET 422 989µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [ERROR] [2022-12-18 00:27:42 +0200] GET 500 0µs   -
  undefined method `book_id' for #<Bookshelf::Actions::Books::Show::Params:0x00007f182da8f7e0 @env={"REQUEST_METHOD"=>"GET"}, @input={}, @params={}, @errors={:book_id=>["is missing"]}>

          rom.relations[:books].by_pk(request.params.book_id).one
                                                    ^^^^^^^^ (NoMethodError)
  /home/vik/repos/bookshelf/app/actions/books/show.rb:27:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:18:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/show_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 200 13ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 200 990µs 127.0.0.1 /books/3 -
  {:id=>"3"}
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 404 686µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 200 597µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 422 989µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:28:00 +0200] GET 200 723µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 200 853µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 200 684µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 404 718µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:28:10 +0200] GET 200 520µs 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 200 12ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 200 715µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 404 738µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 200 569µs 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:28:20 +0200] GET 200 572µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:31:54 +0200] GET 200 1ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:31:55 +0200] GET 404 851ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:31:55 +0200] GET 200 726ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:31:55 +0200] GET 422 3ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:31:55 +0200] GET 200 945µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:31:55 +0200] GET 200 641µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:32:29 +0200] GET 200 1443ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:06 +0200] GET 200 24892ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 200 11ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 404 782µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 200 704µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:33:20 +0200] GET 200 619µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 200 677µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 200 853µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 200 790µs 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:33:22 +0200] GET 404 525µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 404 7ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 200 522µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 200 767µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:33:23 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 200 4ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 200 697µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 200 709µs 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:33:24 +0200] GET 404 516µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:34:02 +0200] GET 200 2252ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:34:03 +0200] GET 404 915ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:34:03 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:34:03 +0200] GET 200 881µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:34:04 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:34:04 +0200] GET 200 575µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:34:31 +0200] GET 200 3ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:34:31 +0200] GET 200 650µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:34:31 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:34:31 +0200] GET 200 681µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:35:35 +0200] GET 200 22380ms 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:35:36 +0200] GET 404 1440ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:35:49 +0200] GET 200 1132ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:35:49 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:35:50 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:35:50 +0200] GET 200 857µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:35:50 +0200] GET 200 653µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:35:53 +0200] GET 200 13ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:35:53 +0200] GET 200 639µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:35:53 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:35:53 +0200] GET 200 736µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:35:55 +0200] GET 200 659ms 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:36:08 +0200] GET 200 1ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:36:08 +0200] GET 200 2ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:36:08 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:36:11 +0200] GET 200 1109ms 127.0.0.1 /books/21 -
  {:id=>"21"}
[bookshelf] [INFO] [2022-12-18 00:36:11 +0200] GET 200 1ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:36:38 +0200] GET 404 1426ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:36:39 +0200] GET 200 2ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:36:39 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:36:39 +0200] GET 200 601µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:36:39 +0200] GET 200 534µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:36:49 +0200] GET 404 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:36:49 +0200] GET 200 813µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:36:49 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:36:49 +0200] GET 200 763µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:36:49 +0200] GET 422 926µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:36:57 +0200] GET 200 13ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:36:57 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:36:57 +0200] GET 404 893µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:36:57 +0200] GET 200 611µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:36:57 +0200] GET 200 756µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:37:57 +0200] GET 200 4ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:37:57 +0200] GET 200 5ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:37:57 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:37:57 +0200] GET 404 3ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:37:58 +0200] GET 200 3ms 127.0.0.1 /books/21 -
  {:id=>"21"}
[bookshelf] [INFO] [2022-12-18 00:37:58 +0200] GET 200 1ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 200 718µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 404 2ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 200 724µs 127.0.0.1 /books/3 -
  {:id=>"3"}
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 200 738µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:38:02 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:38:34 +0200] GET 422 17ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:38:34 +0200] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:38:34 +0200] GET 200 642µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:38:34 +0200] GET 200 553µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:39:02 +0200] GET 404 491ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 200 70192ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 404 609µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 422 3ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 200 816µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 200 535µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:40:14 +0200] GET 200 572µs 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-12-18 00:40:17 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:23:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:40:17 +0200] GET 200 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:40:17 +0200] GET 200 697µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:40:17 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:40:17 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:40:17 +0200] GET 200 629µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 200 17ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 200 735µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 200 554µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:40:39 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:23:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 404 2ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:40:39 +0200] GET 200 466µs 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 200 15ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 200 643µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 200 2ms 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [ERROR] [2022-12-18 00:41:34 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:23:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 404 871µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:41:34 +0200] GET 200 538µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:41:56 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:23:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 404 16ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 200 761µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 200 705µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 422 3ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 200 830µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:41:56 +0200] GET 200 570µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 200 15ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 200 674µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 200 823µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 200 2ms 127.0.0.1 /books/23 -
  {:id=>"23"}
[bookshelf] [ERROR] [2022-12-18 00:42:32 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] GET 404 817µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] POST 405 7µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:42:32 +0200] POST 405 5µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:46:21 +0200] GET 200 12ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:46:21 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:46:21 +0200] GET 200 2ms 127.0.0.1 /books/21 -
  {:id=>"21"}
[bookshelf] [ERROR] [2022-12-18 00:46:21 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:46:21 +0200] GET 404 779µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-12-18 00:46:57 +0200] POST 500 0µs 127.0.0.1 /books -
  {:"{\"book\":{\"title\":null}}"=>nil}
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f38dfdd8c80 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f38e0a7ee08 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f38dfd45fc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f38e0d35b60 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f38dfdd94a0 @router=#<Hanami::Slice::Router:0x00007f38dfc63800 @path_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62ea0 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f38dfc63710 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62e50 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f38dfc62dd8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f38dfc63a80 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f38e0fd6748 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f38dfc627e8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a980 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f38dfc5b7b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a7a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f38dfc533b0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f38dfc5a408 @root=#<Hanami::Router::Node:0x00007f38dfc5a368 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc5a020 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc56010 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54eb8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f38dfc55d40 @root=#<Hanami::Router::Node:0x00007f38dfc55d18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc55b38 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc551b0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54210 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f38e451ca88 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd36430 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd363b8 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:24:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:46:57 +0200] POST 500 0µs 127.0.0.1 /books -
  {:"{\"book\":{\"title\":\"Practical Object-Oriented Design in Ruby\",\"author\":\"Sandi Metz\"}}"=>nil}
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f38dfd5d468 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f38e0a7ee08 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f38dfd45fc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f38e0d35b60 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f38dfd5d6c0 @router=#<Hanami::Slice::Router:0x00007f38dfc63800 @path_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62ea0 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f38dfc63710 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62e50 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f38dfc62dd8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f38dfc63a80 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f38e0fd6748 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f38dfc627e8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a980 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f38dfc5b7b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a7a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f38dfc533b0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f38dfc5a408 @root=#<Hanami::Router::Node:0x00007f38dfc5a368 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc5a020 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc56010 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54eb8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f38dfc55d40 @root=#<Hanami::Router::Node:0x00007f38dfc55d18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc55b38 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc551b0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54210 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f38e451ca88 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd36430 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd363b8 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:46:57 +0200] GET 200 1ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:46:57 +0200] GET 200 704µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-12-18 00:46:58 +0200] GET 500 0µs   -
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f38dfc1cfb8 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f38e0a7ee08 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f38dfd45fc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f38e0d35b60 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f38dfc1d210 @router=#<Hanami::Slice::Router:0x00007f38dfc63800 @path_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62ea0 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f38dfc63710 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f38dfc62e50 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f38dfc62dd8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f38dfc63a80 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f38e0fd6748 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f38dfc627e8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a980 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f38dfc5b7b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f38dfc5a7a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f38dfc533b0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f38dfc5a408 @root=#<Hanami::Router::Node:0x00007f38dfc5a368 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc5a020 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc56010 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54eb8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f38dfc55d40 @root=#<Hanami::Router::Node:0x00007f38dfc55d18 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f38dfc55b38 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f38dfc551b0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f38dfc54210 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f38e451ca88 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f38dfc68300 @notifications=#<Dry::Monitor::Notifications:0x00007f38e0c75f40 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f38e0c70fe0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f38dfc6ce00 @listeners=#<Concurrent::Map:0x00007f38dfc6cec8 entries=3 default_proc=#<Proc:0x00007f38e44f4ba0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f38dfc6d198 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f38dfc68378 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd36430 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f38dfd363b8 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:46:59 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:46:59 +0200] GET 404 13ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:46:59 +0200] GET 200 759µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-12-18 00:47:12 +0200] GET 500 0µs   -
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f6f0abe15d8 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f6f0af85360 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f6f0a170a18 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f6f0b175b20 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f6f0abe1ab0 @router=#<Hanami::Slice::Router:0x00007f6f0a095238 @path_prefix=#<Hanami::Router::Prefix:0x00007f6f0a0948d8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f6f0a095148 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f6f0a094888 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f6f0a094810 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f6f0a0954b8 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f6f0b0d8528 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f6f0a094220 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c3b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f6f0a08d1f0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c1d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f6f0a084de8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f6f0a08be18 @root=#<Hanami::Router::Node:0x00007f6f0a08bd78 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a08ba30 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a087a20 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a0868c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f6f0a087750 @root=#<Hanami::Router::Node:0x00007f6f0a087728 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a087548 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a086bc0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a085c20 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f6f0b2cf048 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e88 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e10 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:47:12 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-12-18 00:47:13 +0200] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>nil}}
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f6f0a0ca000 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f6f0af85360 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f6f0a170a18 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f6f0b175b20 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f6f0a0ca208 @router=#<Hanami::Slice::Router:0x00007f6f0a095238 @path_prefix=#<Hanami::Router::Prefix:0x00007f6f0a0948d8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f6f0a095148 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f6f0a094888 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f6f0a094810 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f6f0a0954b8 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f6f0b0d8528 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f6f0a094220 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c3b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f6f0a08d1f0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c1d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f6f0a084de8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f6f0a08be18 @root=#<Hanami::Router::Node:0x00007f6f0a08bd78 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a08ba30 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a087a20 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a0868c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f6f0a087750 @root=#<Hanami::Router::Node:0x00007f6f0a087728 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a087548 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a086bc0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a085c20 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f6f0b2cf048 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e88 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e10 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:24:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:47:17 +0200] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
  undefined local variable or method `title' for #<Bookshelf::Actions::Books::Create:0x00007f6f0b10c260 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f6f0af85360 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f6f0a170a18 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f6f0b175b20 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f6f0b10e038 @router=#<Hanami::Slice::Router:0x00007f6f0a095238 @path_prefix=#<Hanami::Router::Prefix:0x00007f6f0a0948d8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f6f0a095148 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f6f0a094888 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f6f0a094810 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f6f0a0954b8 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f6f0b0d8528 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f6f0a094220 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c3b8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f6f0a08d1f0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f6f0a08c1d8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f6f0a084de8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f6f0a08be18 @root=#<Hanami::Router::Node:0x00007f6f0a08bd78 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a08ba30 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a087a20 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a0868c8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f6f0a087750 @root=#<Hanami::Router::Node:0x00007f6f0a087728 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f6f0a087548 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f6f0a086bc0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f6f0a085c20 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f6f0b2cf048 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f6f0a099d10 @notifications=#<Dry::Monitor::Notifications:0x00007f6f0b0f53d0 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f6f0b0e7988 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f6f0a09e810 @listeners=#<Concurrent::Map:0x00007f6f0a09e8d8 entries=3 default_proc=#<Proc:0x00007f6f0b0a7270 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f6f0a09eba8 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f6f0a099d88 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e88 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f6f0a160e10 @chain=[]>}>>

          rom.relations[:books].insert(title: title, author: author)
                                              ^^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:19:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:47:17 +0200] GET 200 827µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:47:17 +0200] GET 200 922µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:47:17 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 200 12ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-12-18 00:49:44 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 404 915µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 200 627µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [ERROR] [2022-12-18 00:49:44 +0200] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
  undefined local variable or method `response' for #<Bookshelf::Actions::Books::Create:0x00007f283b784488 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f283c5446b8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f283b730cc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f283c73a120 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f283b784708 @router=#<Hanami::Slice::Router:0x00007f283b61e4b8 @path_prefix=#<Hanami::Router::Prefix:0x00007f283b61db58 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f283b61e3c8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f283b61db08 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f283b61da90 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f283b61e738 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f283c6a7dc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f283b61d4a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615660 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f283b616498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615480 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f283b60e090 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f283b6150e8 @root=#<Hanami::Router::Node:0x00007f283b615048 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b614d00 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b610cf0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60fb70 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f283b610a20 @root=#<Hanami::Router::Node:0x00007f283b6109f8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b610818 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b60fe68 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60eec8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f283c879400 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720e10 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720d98 @chain=[]>}>>

            response.status = 201
            ^^^^^^^^
Did you mean?  respond_to? (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:23:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:49:44 +0200] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>nil}}
  undefined local variable or method `response' for #<Bookshelf::Actions::Books::Create:0x00007f283b72b8b0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f283c5446b8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f283b730cc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f283c73a120 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f283b72bae0 @router=#<Hanami::Slice::Router:0x00007f283b61e4b8 @path_prefix=#<Hanami::Router::Prefix:0x00007f283b61db58 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f283b61e3c8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f283b61db08 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f283b61da90 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f283b61e738 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f283c6a7dc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f283b61d4a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615660 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f283b616498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615480 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f283b60e090 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f283b6150e8 @root=#<Hanami::Router::Node:0x00007f283b615048 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b614d00 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b610cf0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60fb70 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f283b610a20 @root=#<Hanami::Router::Node:0x00007f283b6109f8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b610818 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b60fe68 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60eec8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f283c879400 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720e10 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720d98 @chain=[]>}>>

            response.status = 422
            ^^^^^^^^
Did you mean?  respond_to? (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:26:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:24:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [ERROR] [2022-12-18 00:49:44 +0200] GET 500 0µs   -
  undefined local variable or method `response' for #<Bookshelf::Actions::Books::Create:0x00007f283b6ca538 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f283c5446b8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f283b730cc0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f283c73a120 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f283b6caab0 @router=#<Hanami::Slice::Router:0x00007f283b61e4b8 @path_prefix=#<Hanami::Router::Prefix:0x00007f283b61db58 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f283b61e3c8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f283b61db08 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f283b61da90 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f283b61e738 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f283c6a7dc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f283b61d4a0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615660 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f283b616498 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f283b615480 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f283b60e090 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f283b6150e8 @root=#<Hanami::Router::Node:0x00007f283b615048 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b614d00 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b610cf0 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60fb70 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f283b610a20 @root=#<Hanami::Router::Node:0x00007f283b6109f8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f283b610818 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f283b60fe68 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f283b60eec8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f283c879400 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f283b622f90 @notifications=#<Dry::Monitor::Notifications:0x00007f283c6b0150 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f283c6af278 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f283b627ab8 @listeners=#<Concurrent::Map:0x00007f283b627b80 entries=3 default_proc=#<Proc:0x00007f283c664f20 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f283b627e50 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f283b623008 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720e10 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f283b720d98 @chain=[]>}>>

            response.status = 422
            ^^^^^^^^
Did you mean?  respond_to? (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:26:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/repos/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:49:44 +0200] GET 200 511µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 200 13ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-12-18 00:49:54 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 404 926µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 200 951µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 200 588µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] POST 422 878µs 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [ERROR] [2022-12-18 00:49:54 +0200] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
  undefined local variable or method `book' for #<Bookshelf::Actions::Books::Create:0x00007f1c8bb2d820 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00007f1c8c990d68 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00007f1c8bb7c8f8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:vik@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00007f1c8cb858a8 /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00007f1c8bb2daf0 @router=#<Hanami::Slice::Router:0x00007f1c8ba6a118 @path_prefix=#<Hanami::Router::Prefix:0x00007f1c8ba697b8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00007f1c8ba6a028 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00007f1c8ba6ebf0 @notifications=#<Dry::Monitor::Notifications:0x00007f1c8caf7850 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f1c8caef010 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f1c8ba736f0 @listeners=#<Concurrent::Map:0x00007f1c8ba737b8 entries=3 default_proc=#<Proc:0x00007f1c8caacbc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f1c8ba73a88 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f1c8ba6ec68 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00007f1c8ba69768 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00007f1c8ba696f0 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00007f1c8ba6a398 @slice=Bookshelf::App>, @not_found=#<Proc:0x00007f1c8cae0808 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00007f1c8ba69100 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f1c8ba612c0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x00007f1c8ba620f8 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00007f1c8ba610e0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x00007f1c8ba59cf0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x00007f1c8ba60d48 @root=#<Hanami::Router::Node:0x00007f1c8ba60ca8 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f1c8ba60960 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f1c8ba5c950 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f1c8ba5b7d0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x00007f1c8ba5c680 @root=#<Hanami::Router::Node:0x00007f1c8ba5c658 @variable=nil, @fixed={"books"=>#<Hanami::Router::Node:0x00007f1c8ba5c478 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x00007f1c8ba5bac8 @variable=nil, @fixed=nil, @to=#<Proc:0x00007f1c8ba5ab28 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00007f1c8ccdd2f0 /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00007f1c8ba6ebf0 @notifications=#<Dry::Monitor::Notifications:0x00007f1c8caf7850 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00007f1c8caef010 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00007f1c8ba736f0 @listeners=#<Concurrent::Map:0x00007f1c8ba737b8 entries=3 default_proc=#<Proc:0x00007f1c8caacbc0 /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00007f1c8ba73a88 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00007f1c8ba6ec68 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';child-src 'self';connect-src 'self';default-src 'none';font-src 'self';form-action 'self';frame-ancestors 'self';frame-src 'self';img-src 'self' https: data:;media-src 'self';object-src 'none';plugin-types application/pdf;script-src 'self';style-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/home/vik/repos/bookshelf>, :public_directory=>"/home/vik/repos/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f1c8bb6ca48 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00007f1c8bb6c9d0 @chain=[]>}>>

            response.body = book.to_json
                            ^^^^ (NameError)
  /home/vik/repos/bookshelf/app/actions/books/create.rb:24:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /home/vik/repos/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:49:54 +0200] GET 200 580µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 200 9ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 200 4ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] POST 422 1ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] POST 201 484µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [ERROR] [2022-12-18 00:50:25 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 404 2ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 200 599µs 127.0.0.1 /books/21 -
  {:id=>"21"}
[bookshelf] [INFO] [2022-12-18 00:50:25 +0200] GET 200 601µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] POST 422 25ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] POST 201 585µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 200 1ms 127.0.0.1 /books/3 -
  {:id=>"3"}
[bookshelf] [ERROR] [2022-12-18 00:50:46 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 404 778µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 200 678µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 422 969µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:50:46 +0200] GET 200 578µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] POST 422 23ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] POST 201 568µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [ERROR] [2022-12-18 00:51:28 +0200] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:21:in `find_book'
  /home/vik/repos/bookshelf/app/actions/books/show.rb:17:in `handle'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/hanami-2.0.1/lib/hanami/slice.rb:758:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /home/vik/repos/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /home/vik/.rvm/rubies/ruby-3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /home/vik/repos/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /home/vik/.rvm/gems/ruby-3.1.2/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `load'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/rspec:25:in `<main>'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `eval'
  /home/vik/.rvm/gems/ruby-3.1.2/bin/ruby_executable_hooks:22:in `<main>'
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 404 2ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 200 638µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 200 615µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 200 2ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-12-18 00:51:28 +0200] GET 200 701µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
